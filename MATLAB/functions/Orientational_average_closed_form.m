
function sigmaeff = Orientational_average_closed_form(Sigma,strain)

% Conductividades efectivas;
%Ec. (27)-(29), sin el primer te'rmino sigma_m;
% Variables:
% Eps son los Epsilon raya (1+epsilon)
% Sigma11, etc.: Son las componentes del Sigma a promediar
% 
% SigmaPromedio11:

Sigma11 = Sigma(1,1);
Sigma33 = Sigma(3,3);
Eps1 = strain(1)+1;
Eps2 = strain(2)+1;
Eps3 = strain(3)+1;

SigmaPromedio11=(1/15).*(5.*(2.*Sigma11+Sigma33)+4.*5.^(1/2).*pi.^2.*( ...
  Sigma11+(-1).*Sigma33).*((sqrt(-1)*(1/8008)).*5.^(-1/2).* ...
  Eps1.*(Eps1+(-1).*Eps2).*Eps2.*(Eps1.^2.*Eps2.^2).^(1/2).* ...
  Eps3.^2.*(5.*(65760+(-37329).*Eps2+Eps1.*((-37329)+17192.* ...
  Eps2))+(-40).*(11448+(-6521).*Eps2+Eps1.*((-6521)+3024.* ...
  Eps2)).*Eps3+8.*(21860+(-12474).*Eps2+27.*Eps1.*((-462)+ ...
  215.*Eps2)).*Eps3.^2).*pi.^(-1).*(log((sqrt(-1)*(-1)).* ...
  Eps1.*Eps2.^(-1))+(-1).*log(sqrt(-1).*Eps1.*Eps2.^(-1))).^( ...
  -1)+(sqrt(-1)*(-1/8008)).*5.^(-1/2).*Eps1.*Eps2.*(Eps1.^2.* ...
  Eps2.^2).^(1/2).*Eps3.^2.*(5.*Eps2.*((-21920)+12443.*Eps2)+ ...
  40.*(5480+(-3816).*Eps2+741.*Eps2.^2).*Eps3+(-2).*(62215+8.* ...
  Eps2.*((-7225)+2079.*Eps2)).*Eps3.^2+40.*Eps1.*((-2740)+ ...
  7632.*Eps2+(-3631).*Eps2.^2+72.*((-53)+14.*Eps2.^2).*Eps3+( ...
  2890+9.*Eps2.*((-224)+43.*Eps2)).*Eps3.^2)+Eps1.^2.*(62215+ ...
  29640.*Eps3+8.*(Eps2.*((-18155)+8316.*Eps2)+90.*(56+(-43).* ...
  Eps2).*Eps2.*Eps3+9.*((-462)+215.*Eps2).*Eps3.^2))).*pi.^( ...
  -1).*(log((sqrt(-1)*(-1)).*Eps1.*Eps2.^(-1))+(-1).*log(sqrt( ...
  -1).*Eps1.*Eps2.^(-1))).^(-1)));
%;
% SigmaPromedio22:;
SigmaPromedio22=(1/15).*(5.*(2.*Sigma11+Sigma33)+4.*5.^(1/2).*pi.^2.*( ...
  Sigma11+(-1).*Sigma33).*((sqrt(-1)*(-1/8008)).*5.^(-1/2).* ...
  Eps1.*(Eps1+(-1).*Eps2).*Eps2.*(Eps1.^2.*Eps2.^2).^(1/2).* ...
  Eps3.^2.*(5.*(65760+(-37329).*Eps2+Eps1.*((-37329)+17192.* ...
  Eps2))+(-40).*(11448+(-6521).*Eps2+Eps1.*((-6521)+3024.* ...
  Eps2)).*Eps3+8.*(21860+(-12474).*Eps2+27.*Eps1.*((-462)+ ...
  215.*Eps2)).*Eps3.^2).*pi.^(-1).*(log((sqrt(-1)*(-1)).* ...
  Eps1.*Eps2.^(-1))+(-1).*log(sqrt(-1).*Eps1.*Eps2.^(-1))).^( ...
  -1)+(sqrt(-1)*(-1/8008)).*5.^(-1/2).*Eps1.*Eps2.*(Eps1.^2.* ...
  Eps2.^2).^(1/2).*Eps3.^2.*(5.*Eps2.*((-21920)+12443.*Eps2)+ ...
  40.*(5480+(-3816).*Eps2+741.*Eps2.^2).*Eps3+(-2).*(62215+8.* ...
  Eps2.*((-7225)+2079.*Eps2)).*Eps3.^2+40.*Eps1.*((-2740)+ ...
  7632.*Eps2+(-3631).*Eps2.^2+72.*((-53)+14.*Eps2.^2).*Eps3+( ...
  2890+9.*Eps2.*((-224)+43.*Eps2)).*Eps3.^2)+Eps1.^2.*(62215+ ...
  29640.*Eps3+8.*(Eps2.*((-18155)+8316.*Eps2)+90.*(56+(-43).* ...
  Eps2).*Eps2.*Eps3+9.*((-462)+215.*Eps2).*Eps3.^2))).*pi.^( ...
  -1).*(log((sqrt(-1)*(-1)).*Eps1.*Eps2.^(-1))+(-1).*log(sqrt( ...
  -1).*Eps1.*Eps2.^(-1))).^(-1)));
%;
% SigmaPromedio33:;
SigmaPromedio33=(1/15).*(5.*(2.*Sigma11+Sigma33)+(sqrt(-1)*(-1/1001)).* ...
  Eps1.*Eps2.*(Eps1.^2.*Eps2.^2).^(1/2).*Eps3.^2.*(5.*Eps2.*(( ...
  -21920)+12443.*Eps2)+40.*(5480+(-3816).*Eps2+741.*Eps2.^2).* ...
  Eps3+(-2).*(62215+8.*Eps2.*((-7225)+2079.*Eps2)).*Eps3.^2+ ...
  40.*Eps1.*((-2740)+7632.*Eps2+(-3631).*Eps2.^2+72.*((-53)+ ...
  14.*Eps2.^2).*Eps3+(2890+9.*Eps2.*((-224)+43.*Eps2)).* ...
  Eps3.^2)+Eps1.^2.*(62215+29640.*Eps3+8.*(Eps2.*((-18155)+ ...
  8316.*Eps2)+90.*(56+(-43).*Eps2).*Eps2.*Eps3+9.*((-462)+ ...
  215.*Eps2).*Eps3.^2))).*pi.*((-1).*Sigma11+Sigma33).*(log(( ...
  sqrt(-1)*(-1)).*Eps1.*Eps2.^(-1))+(-1).*log(sqrt(-1).*Eps1.* ...
  Eps2.^(-1))).^(-1));
%;
% SigmaPromedio0 (sin def.):;
SigmaPromedio11=(1/3).*(2.*Sigma11+Sigma33);

sigmaeff = [SigmaPromedio11,0,0;0,SigmaPromedio22,0;0,0,SigmaPromedio33];

end
